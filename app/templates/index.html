<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MG Event Hub âš¡</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.js'></script>
    <style>
        body { background: #f8fafc; font-family: sans-serif; }
        .fc-event { cursor: pointer; border: none !important; padding: 3px; border-radius: 6px; font-weight: bold; font-size: 0.7rem; }
        .source-sympla { background: #f97316 !important; } /* Laranja */
        .source-portal { background: #10b981 !important; } /* Verde */
        .source-fcs { background: #6366f1 !important; }    /* Indigo */
        .card { transition: transform 0.2s; border-left: 6px solid #e2e8f0; }
        .card:hover { transform: translateY(-4px); }
    </style>
</head>
<body class="max-w-4xl mx-auto p-4 md:p-8">
    <header class="mb-8">
        <h1 class="text-3xl font-black text-slate-900 tracking-tight">MINAS EVENTOS <span class="text-blue-600 italic">HUB</span></h1>
        <p id="stats" class="text-xs font-bold text-slate-400 uppercase tracking-widest mt-1">Carregando Obra de Arte...</p>
    </header>

    <div id="calendar" class="bg-white p-6 rounded-3xl shadow-xl mb-10 border border-slate-100"></div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6" id="feed"></div>

    <script>
        const colors = { 'Sympla': 'source-sympla', 'Portal': 'source-portal', 'FCS': 'source-fcs' };

        async function init() {
            const r = await fetch(`static/export_eventos.json?t=${Date.now()}`);
            const d = await r.json();
            
            document.getElementById('stats').innerText = `${d.total} Eventos Sincronizados`;
            
            const calendar = new FullCalendar.Calendar(document.getElementById('calendar'), {
                initialView: 'dayGridMonth',
                locale: 'pt-br',
                events: d.eventos.map(e => ({
                    title: e.titulo,
                    start: e.data,
                    className: colors[e.fonte.includes('Sympla') ? 'Sympla' : e.fonte.includes('Portal') ? 'Portal' : 'FCS']
                }))
            });
            calendar.render();

            const render = (list) => {
                document.getElementById('feed').innerHTML = list.map(e => `
                    <div class="bg-white p-6 rounded-3xl shadow-sm card" style="border-left-color: ${e.fonte.includes('Sympla') ? '#f97316' : e.fonte.includes('Portal') ? '#10b981' : '#6366f1'}">
                        <span class="text-[10px] font-bold text-slate-400 uppercase tracking-widest">${e.fonte}</span>
                        <h2 class="text-lg font-bold text-slate-800 my-2 leading-tight">${e.titulo}</h2>
                        <div class="flex justify-between items-end mt-4">
                            <span class="text-blue-600 font-bold text-sm">${new Date(e.data).toLocaleDateString('pt-BR')}</span>
                            <a href="${e.url_evento}" target="_blank" class="bg-slate-900 text-white text-[10px] font-bold px-4 py-2 rounded-xl">DETALHES</a>
                        </div>
                    </div>
                `).join('');
            };
            render(d.eventos);
        }
        init();
    </script>
</body>
</html>
